/home/pkadukar/miniconda3/envs/furi310/lib/python3.10/site-packages/transformers/utils/hub.py:110: FutureWarning: Using `TRANSFORMERS_CACHE` is deprecated and will be removed in v5 of Transformers. Use `HF_HOME` instead.
  warnings.warn(
Some weights of ViTForImageClassification were not initialized from the model checkpoint at google/vit-base-patch16-224 and are newly initialized because the shapes did not match:
- classifier.bias: found shape torch.Size([1000]) in the checkpoint and torch.Size([10]) in the model instantiated
- classifier.weight: found shape torch.Size([1000, 768]) in the checkpoint and torch.Size([10, 768]) in the model instantiated
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
Detected kernel version 4.18.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
Loaded: (145, 145, 200) (145, 145)
Grid coords: 289 | train coords: 145 | val coords: 144
Tiles (pre-filter): train=108 val=106
After rarity filter: train=103 val=101 classes=[2, 3, 5, 6, 8, 10, 11, 12, 14, 15]
Train class counts: {3: 7, 12: 8, 15: 3, 11: 26, 2: 14, 14: 18, 10: 7, 8: 6, 6: 7, 5: 7}
Val   class counts: {3: 7, 12: 7, 15: 3, 11: 23, 14: 17, 2: 14, 10: 7, 8: 6, 6: 10, 5: 7}
  0%|          | 0/390 [00:00<?, ?it/s]  0%|          | 1/390 [00:18<1:58:02, 18.21s/it]  1%|          | 2/390 [00:21<59:38,  9.22s/it]    1%|          | 3/390 [00:24<41:02,  6.36s/it]  1%|          | 4/390 [00:27<32:12,  5.01s/it]  1%|▏         | 5/390 [00:29<27:04,  4.22s/it]  2%|▏         | 6/390 [00:32<23:57,  3.74s/it]  2%|▏         | 7/390 [00:35<22:00,  3.45s/it]  2%|▏         | 8/390 [00:38<20:48,  3.27s/it]  2%|▏         | 9/390 [00:41<20:05,  3.16s/it]  3%|▎         | 10/390 [00:44<19:34,  3.09s/it]  3%|▎         | 11/390 [00:47<19:01,  3.01s/it]  3%|▎         | 12/390 [00:49<18:41,  2.97s/it]  3%|▎         | 13/390 [00:52<18:33,  2.95s/it]  4%|▎         | 14/390 [00:55<18:26,  2.94s/it]  4%|▍         | 15/390 [00:58<18:22,  2.94s/it]  4%|▍         | 16/390 [01:01<18:21,  2.94s/it]  4%|▍         | 17/390 [01:04<18:17,  2.94s/it]  5%|▍         | 18/390 [01:07<17:57,  2.90s/it]  5%|▍         | 19/390 [01:10<17:45,  2.87s/it]  5%|▌         | 20/390 [01:13<17:37,  2.86s/it]                                                  5%|▌         | 20/390 [01:13<17:37,  2.86s/it]  5%|▌         | 21/390 [01:15<17:29,  2.84s/it]  6%|▌         | 22/390 [01:18<17:27,  2.85s/it]  6%|▌         | 23/390 [01:21<17:37,  2.88s/it]  6%|▌         | 24/390 [01:24<17:42,  2.90s/it]  6%|▋         | 25/390 [01:27<17:52,  2.94s/it]  7%|▋         | 26/390 [01:29<16:44,  2.76s/it]  7%|▋         | 27/390 [01:32<17:05,  2.82s/it]  7%|▋         | 28/390 [01:35<17:16,  2.86s/it]  7%|▋         | 29/390 [01:38<17:19,  2.88s/it]  8%|▊         | 30/390 [01:41<17:27,  2.91s/it]  8%|▊         | 31/390 [01:44<17:28,  2.92s/it]  8%|▊         | 32/390 [01:47<17:27,  2.92s/it]  8%|▊         | 33/390 [01:50<17:14,  2.90s/it]  9%|▊         | 34/390 [01:53<17:04,  2.88s/it]  9%|▉         | 35/390 [01:56<16:57,  2.87s/it]  9%|▉         | 36/390 [01:59<16:52,  2.86s/it]  9%|▉         | 37/390 [02:01<16:53,  2.87s/it] 10%|▉         | 38/390 [02:04<16:56,  2.89s/it] 10%|█         | 39/390 [02:07<16:58,  2.90s/it] 10%|█         | 40/390 [02:10<17:03,  2.92s/it]                                                 10%|█         | 40/390 [02:10<17:03,  2.92s/it] 11%|█         | 41/390 [02:13<17:07,  2.94s/it] 11%|█         | 42/390 [02:16<17:00,  2.93s/it] 11%|█         | 43/390 [02:19<17:00,  2.94s/it] 11%|█▏        | 44/390 [02:22<17:04,  2.96s/it] 12%|█▏        | 45/390 [02:25<17:01,  2.96s/it] 12%|█▏        | 46/390 [02:28<16:59,  2.96s/it] 12%|█▏        | 47/390 [02:31<16:56,  2.96s/it] 12%|█▏        | 48/390 [02:34<16:52,  2.96s/it] 13%|█▎        | 49/390 [02:37<16:49,  2.96s/it] 13%|█▎        | 50/390 [02:40<16:43,  2.95s/it] 13%|█▎        | 51/390 [02:43<16:35,  2.94s/it] 13%|█▎        | 52/390 [02:45<15:22,  2.73s/it] 14%|█▎        | 53/390 [02:48<15:44,  2.80s/it] 14%|█▍        | 54/390 [02:51<15:56,  2.85s/it] 14%|█▍        | 55/390 [02:54<16:01,  2.87s/it] 14%|█▍        | 56/390 [02:57<16:05,  2.89s/it] 15%|█▍        | 57/390 [03:00<16:10,  2.92s/it] 15%|█▍        | 58/390 [03:03<16:08,  2.92s/it] 15%|█▌        | 59/390 [03:06<16:07,  2.92s/it] 15%|█▌        | 60/390 [03:09<15:59,  2.91s/it]                                                 15%|█▌        | 60/390 [03:09<15:59,  2.91s/it] 16%|█▌        | 61/390 [03:11<15:50,  2.89s/it] 16%|█▌        | 62/390 [03:14<15:49,  2.90s/it] 16%|█▌        | 63/390 [03:17<15:46,  2.89s/it] 16%|█▋        | 64/390 [03:20<15:47,  2.91s/it] 17%|█▋        | 65/390 [03:23<15:45,  2.91s/it] 17%|█▋        | 66/390 [03:26<15:45,  2.92s/it] 17%|█▋        | 67/390 [03:29<15:44,  2.92s/it] 17%|█▋        | 68/390 [03:32<15:41,  2.92s/it] 18%|█▊        | 69/390 [03:35<15:44,  2.94s/it] 18%|█▊        | 70/390 [03:38<15:50,  2.97s/it] 18%|█▊        | 71/390 [03:41<15:54,  2.99s/it] 18%|█▊        | 72/390 [03:44<15:56,  3.01s/it] 19%|█▊        | 73/390 [03:47<15:50,  3.00s/it] 19%|█▉        | 74/390 [03:50<15:41,  2.98s/it] 19%|█▉        | 75/390 [03:53<15:36,  2.97s/it] 19%|█▉        | 76/390 [03:56<15:28,  2.96s/it] 20%|█▉        | 77/390 [03:59<15:23,  2.95s/it] 20%|██        | 78/390 [04:01<14:17,  2.75s/it] 20%|██        | 79/390 [04:04<14:30,  2.80s/it] 21%|██        | 80/390 [04:07<14:42,  2.85s/it]                                                 21%|██        | 80/390 [04:07<14:42,  2.85s/it] 21%|██        | 81/390 [04:10<14:50,  2.88s/it] 21%|██        | 82/390 [04:13<14:53,  2.90s/it] 21%|██▏       | 83/390 [04:16<14:46,  2.89s/it] 22%|██▏       | 84/390 [04:19<14:47,  2.90s/it] 22%|██▏       | 85/390 [04:21<14:47,  2.91s/it] 22%|██▏       | 86/390 [04:24<14:47,  2.92s/it] 22%|██▏       | 87/390 [04:27<14:48,  2.93s/it] 23%|██▎       | 88/390 [04:30<14:46,  2.93s/it] 23%|██▎       | 89/390 [04:33<14:38,  2.92s/it] 23%|██▎       | 90/390 [04:36<14:28,  2.89s/it] 23%|██▎       | 91/390 [04:39<14:28,  2.90s/it] 24%|██▎       | 92/390 [04:42<14:28,  2.91s/it] 24%|██▍       | 93/390 [04:45<14:24,  2.91s/it] 24%|██▍       | 94/390 [04:48<14:24,  2.92s/it] 24%|██▍       | 95/390 [04:51<14:21,  2.92s/it] 25%|██▍       | 96/390 [04:54<14:19,  2.93s/it] 25%|██▍       | 97/390 [04:57<14:18,  2.93s/it] 25%|██▌       | 98/390 [04:59<14:18,  2.94s/it] 25%|██▌       | 99/390 [05:02<14:15,  2.94s/it] 26%|██▌       | 100/390 [05:05<14:00,  2.90s/it]                                                  26%|██▌       | 100/390 [05:05<14:00,  2.90s/it] 26%|██▌       | 101/390 [05:08<13:50,  2.88s/it] 26%|██▌       | 102/390 [05:11<13:40,  2.85s/it] 26%|██▋       | 103/390 [05:14<13:35,  2.84s/it] 27%|██▋       | 104/390 [05:16<12:40,  2.66s/it] 27%|██▋       | 105/390 [05:19<12:49,  2.70s/it] 27%|██▋       | 106/390 [05:21<12:55,  2.73s/it] 27%|██▋       | 107/390 [05:24<12:56,  2.75s/it] 28%|██▊       | 108/390 [05:27<12:58,  2.76s/it] 28%|██▊       | 109/390 [05:30<13:01,  2.78s/it] 28%|██▊       | 110/390 [05:33<13:02,  2.79s/it] 28%|██▊       | 111/390 [05:36<13:04,  2.81s/it] 29%|██▊       | 112/390 [05:38<13:03,  2.82s/it] 29%|██▉       | 113/390 [05:41<13:03,  2.83s/it] 29%|██▉       | 114/390 [05:44<12:59,  2.82s/it] 29%|██▉       | 115/390 [05:47<12:54,  2.82s/it] 30%|██▉       | 116/390 [05:50<12:51,  2.82s/it] 30%|███       | 117/390 [05:52<12:48,  2.81s/it] 30%|███       | 118/390 [05:55<12:42,  2.80s/it] 31%|███       | 119/390 [05:58<12:40,  2.81s/it] 31%|███       | 120/390 [06:01<12:37,  2.80s/it]                                                  31%|███       | 120/390 [06:01<12:37,  2.80s/it] 31%|███       | 121/390 [06:04<12:34,  2.80s/it] 31%|███▏      | 122/390 [06:06<12:32,  2.81s/it] 32%|███▏      | 123/390 [06:09<12:31,  2.81s/it] 32%|███▏      | 124/390 [06:12<12:30,  2.82s/it] 32%|███▏      | 125/390 [06:15<12:28,  2.82s/it] 32%|███▏      | 126/390 [06:18<12:27,  2.83s/it] 33%|███▎      | 127/390 [06:21<12:25,  2.84s/it] 33%|███▎      | 128/390 [06:24<12:23,  2.84s/it] 33%|███▎      | 129/390 [06:26<12:20,  2.84s/it] 33%|███▎      | 130/390 [06:29<11:30,  2.66s/it] 34%|███▎      | 131/390 [06:31<11:42,  2.71s/it] 34%|███▍      | 132/390 [06:34<11:49,  2.75s/it] 34%|███▍      | 133/390 [06:37<11:52,  2.77s/it] 34%|███▍      | 134/390 [06:40<11:54,  2.79s/it] 35%|███▍      | 135/390 [06:43<11:56,  2.81s/it] 35%|███▍      | 136/390 [06:46<11:56,  2.82s/it] 35%|███▌      | 137/390 [06:49<11:56,  2.83s/it] 35%|███▌      | 138/390 [06:51<11:54,  2.84s/it] 36%|███▌      | 139/390 [06:54<11:51,  2.83s/it] 36%|███▌      | 140/390 [06:57<11:49,  2.84s/it]                                                  36%|███▌      | 140/390 [06:57<11:49,  2.84s/it] 36%|███▌      | 141/390 [07:00<11:44,  2.83s/it] 36%|███▋      | 142/390 [07:03<11:39,  2.82s/it] 37%|███▋      | 143/390 [07:05<11:36,  2.82s/it] 37%|███▋      | 144/390 [07:08<11:33,  2.82s/it] 37%|███▋      | 145/390 [07:11<11:29,  2.81s/it] 37%|███▋      | 146/390 [07:14<11:23,  2.80s/it] 38%|███▊      | 147/390 [07:17<11:20,  2.80s/it] 38%|███▊      | 148/390 [07:19<11:18,  2.80s/it] 38%|███▊      | 149/390 [07:22<11:15,  2.80s/it] 38%|███▊      | 150/390 [07:25<11:12,  2.80s/it] 39%|███▊      | 151/390 [07:28<11:07,  2.79s/it] 39%|███▉      | 152/390 [07:31<11:04,  2.79s/it] 39%|███▉      | 153/390 [07:33<11:01,  2.79s/it] 39%|███▉      | 154/390 [07:36<10:59,  2.79s/it] 40%|███▉      | 155/390 [07:39<10:56,  2.79s/it] 40%|████      | 156/390 [07:41<10:09,  2.60s/it] 40%|████      | 157/390 [07:44<10:20,  2.66s/it] 41%|████      | 158/390 [07:47<10:26,  2.70s/it] 41%|████      | 159/390 [07:50<10:30,  2.73s/it] 41%|████      | 160/390 [07:52<10:32,  2.75s/it]                                                  41%|████      | 160/390 [07:52<10:32,  2.75s/it] 41%|████▏     | 161/390 [07:55<10:34,  2.77s/it] 42%|████▏     | 162/390 [07:58<10:35,  2.79s/it] 42%|████▏     | 163/390 [08:01<10:34,  2.80s/it] 42%|████▏     | 164/390 [08:04<10:31,  2.79s/it] 42%|████▏     | 165/390 [08:06<10:30,  2.80s/it] 43%|████▎     | 166/390 [08:09<10:27,  2.80s/it] 43%|████▎     | 167/390 [08:12<10:25,  2.80s/it] 43%|████▎     | 168/390 [08:15<10:23,  2.81s/it] 43%|████▎     | 169/390 [08:18<10:21,  2.81s/it] 44%|████▎     | 170/390 [08:20<10:18,  2.81s/it] 44%|████▍     | 171/390 [08:23<10:15,  2.81s/it] 44%|████▍     | 172/390 [08:26<10:12,  2.81s/it] 44%|████▍     | 173/390 [08:29<10:08,  2.80s/it] 45%|████▍     | 174/390 [08:32<10:05,  2.81s/it] 45%|████▍     | 175/390 [08:34<10:02,  2.80s/it] 45%|████▌     | 176/390 [08:37<09:59,  2.80s/it] 45%|████▌     | 177/390 [08:40<09:58,  2.81s/it] 46%|████▌     | 178/390 [08:43<09:56,  2.82s/it] 46%|████▌     | 179/390 [08:46<09:57,  2.83s/it] 46%|████▌     | 180/390 [08:49<09:54,  2.83s/it]                                                  46%|████▌     | 180/390 [08:49<09:54,  2.83s/it] 46%|████▋     | 181/390 [08:52<09:54,  2.84s/it] 47%|████▋     | 182/390 [08:54<09:13,  2.66s/it] 47%|████▋     | 183/390 [08:57<09:24,  2.73s/it] 47%|████▋     | 184/390 [08:59<09:29,  2.76s/it] 47%|████▋     | 185/390 [09:02<09:31,  2.79s/it] 48%|████▊     | 186/390 [09:05<09:31,  2.80s/it] 48%|████▊     | 187/390 [09:08<09:31,  2.81s/it] 48%|████▊     | 188/390 [09:11<09:29,  2.82s/it] 48%|████▊     | 189/390 [09:14<09:26,  2.82s/it] 49%|████▊     | 190/390 [09:16<09:23,  2.82s/it] 49%|████▉     | 191/390 [09:19<09:20,  2.82s/it] 49%|████▉     | 192/390 [09:22<09:17,  2.82s/it] 49%|████▉     | 193/390 [09:25<09:14,  2.81s/it] 50%|████▉     | 194/390 [09:28<09:11,  2.82s/it] 50%|█████     | 195/390 [09:31<09:08,  2.81s/it] 50%|█████     | 196/390 [09:33<09:04,  2.81s/it] 51%|█████     | 197/390 [09:36<09:03,  2.82s/it] 51%|█████     | 198/390 [09:39<09:00,  2.82s/it] 51%|█████     | 199/390 [09:42<08:58,  2.82s/it] 51%|█████▏    | 200/390 [09:45<08:54,  2.82s/it]                                                  51%|█████▏    | 200/390 [09:45<08:54,  2.82s/it] 52%|█████▏    | 201/390 [09:47<08:51,  2.81s/it] 52%|█████▏    | 202/390 [09:50<08:51,  2.83s/it] 52%|█████▏    | 203/390 [09:53<08:50,  2.83s/it] 52%|█████▏    | 204/390 [09:56<08:46,  2.83s/it] 53%|█████▎    | 205/390 [09:59<08:42,  2.82s/it] 53%|█████▎    | 206/390 [10:02<08:38,  2.82s/it] 53%|█████▎    | 207/390 [10:04<08:36,  2.82s/it] 53%|█████▎    | 208/390 [10:07<08:01,  2.65s/it] 54%|█████▎    | 209/390 [10:09<08:07,  2.69s/it] 54%|█████▍    | 210/390 [10:12<08:12,  2.74s/it] 54%|█████▍    | 211/390 [10:15<08:13,  2.76s/it] 54%|█████▍    | 212/390 [10:18<08:15,  2.78s/it] 55%|█████▍    | 213/390 [10:21<08:15,  2.80s/it] 55%|█████▍    | 214/390 [10:24<08:17,  2.82s/it] 55%|█████▌    | 215/390 [10:27<08:16,  2.84s/it] 55%|█████▌    | 216/390 [10:29<08:18,  2.86s/it] 56%|█████▌    | 217/390 [10:32<08:14,  2.86s/it] 56%|█████▌    | 218/390 [10:35<08:11,  2.86s/it] 56%|█████▌    | 219/390 [10:38<08:08,  2.86s/it] 56%|█████▋    | 220/390 [10:41<08:04,  2.85s/it]                                                  56%|█████▋    | 220/390 [10:41<08:04,  2.85s/it] 57%|█████▋    | 221/390 [10:44<08:01,  2.85s/it] 57%|█████▋    | 222/390 [10:47<07:57,  2.84s/it] 57%|█████▋    | 223/390 [10:49<07:57,  2.86s/it] 57%|█████▋    | 224/390 [10:52<07:55,  2.86s/it] 58%|█████▊    | 225/390 [10:55<07:51,  2.86s/it] 58%|█████▊    | 226/390 [10:58<07:50,  2.87s/it] 58%|█████▊    | 227/390 [11:01<07:46,  2.86s/it] 58%|█████▊    | 228/390 [11:04<07:43,  2.86s/it] 59%|█████▊    | 229/390 [11:07<07:39,  2.85s/it] 59%|█████▉    | 230/390 [11:09<07:37,  2.86s/it] 59%|█████▉    | 231/390 [11:12<07:33,  2.85s/it] 59%|█████▉    | 232/390 [11:15<07:30,  2.85s/it] 60%|█████▉    | 233/390 [11:18<07:26,  2.85s/it] 60%|██████    | 234/390 [11:20<06:56,  2.67s/it] 60%|██████    | 235/390 [11:23<07:02,  2.72s/it] 61%|██████    | 236/390 [11:26<07:05,  2.76s/it] 61%|██████    | 237/390 [11:29<07:05,  2.78s/it] 61%|██████    | 238/390 [11:32<07:06,  2.80s/it] 61%|██████▏   | 239/390 [11:35<07:08,  2.84s/it] 62%|██████▏   | 240/390 [11:37<07:06,  2.84s/it]                                                  62%|██████▏   | 240/390 [11:37<07:06,  2.84s/it] 62%|██████▏   | 241/390 [11:40<07:02,  2.84s/it] 62%|██████▏   | 242/390 [11:43<07:00,  2.84s/it] 62%|██████▏   | 243/390 [11:46<06:58,  2.85s/it] 63%|██████▎   | 244/390 [11:49<06:55,  2.84s/it] 63%|██████▎   | 245/390 [11:52<06:52,  2.84s/it] 63%|██████▎   | 246/390 [11:54<06:49,  2.84s/it] 63%|██████▎   | 247/390 [11:57<06:47,  2.85s/it] 64%|██████▎   | 248/390 [12:00<06:45,  2.85s/it] 64%|██████▍   | 249/390 [12:03<06:42,  2.85s/it] 64%|██████▍   | 250/390 [12:06<06:39,  2.85s/it] 64%|██████▍   | 251/390 [12:09<06:36,  2.85s/it] 65%|██████▍   | 252/390 [12:12<06:32,  2.84s/it] 65%|██████▍   | 253/390 [12:14<06:29,  2.84s/it] 65%|██████▌   | 254/390 [12:17<06:26,  2.84s/it] 65%|██████▌   | 255/390 [12:20<06:23,  2.84s/it] 66%|██████▌   | 256/390 [12:23<06:19,  2.84s/it] 66%|██████▌   | 257/390 [12:26<06:16,  2.83s/it] 66%|██████▌   | 258/390 [12:29<06:14,  2.84s/it] 66%|██████▋   | 259/390 [12:31<06:13,  2.85s/it] 67%|██████▋   | 260/390 [12:34<05:46,  2.67s/it]                                                  67%|██████▋   | 260/390 [12:34<05:46,  2.67s/it] 67%|██████▋   | 261/390 [12:36<05:50,  2.72s/it] 67%|██████▋   | 262/390 [12:39<05:52,  2.75s/it] 67%|██████▋   | 263/390 [12:42<05:53,  2.78s/it] 68%|██████▊   | 264/390 [12:45<05:52,  2.80s/it] 68%|██████▊   | 265/390 [12:48<05:51,  2.82s/it] 68%|██████▊   | 266/390 [12:51<05:49,  2.82s/it] 68%|██████▊   | 267/390 [12:54<05:48,  2.83s/it] 69%|██████▊   | 268/390 [12:56<05:46,  2.84s/it] 69%|██████▉   | 269/390 [12:59<05:43,  2.84s/it] 69%|██████▉   | 270/390 [13:02<05:43,  2.86s/it] 69%|██████▉   | 271/390 [13:05<05:40,  2.86s/it] 70%|██████▉   | 272/390 [13:08<05:37,  2.86s/it] 70%|███████   | 273/390 [13:11<05:34,  2.86s/it] 70%|███████   | 274/390 [13:14<05:31,  2.85s/it] 71%|███████   | 275/390 [13:16<05:28,  2.86s/it] 71%|███████   | 276/390 [13:19<05:24,  2.85s/it] 71%|███████   | 277/390 [13:22<05:21,  2.84s/it] 71%|███████▏  | 278/390 [13:25<05:18,  2.84s/it] 72%|███████▏  | 279/390 [13:28<05:14,  2.84s/it] 72%|███████▏  | 280/390 [13:31<05:12,  2.84s/it]                                                  72%|███████▏  | 280/390 [13:31<05:12,  2.84s/it] 72%|███████▏  | 281/390 [13:33<05:10,  2.84s/it] 72%|███████▏  | 282/390 [13:36<05:08,  2.85s/it] 73%|███████▎  | 283/390 [13:39<05:06,  2.87s/it] 73%|███████▎  | 284/390 [13:42<05:04,  2.87s/it] 73%|███████▎  | 285/390 [13:45<05:00,  2.86s/it] 73%|███████▎  | 286/390 [13:47<04:39,  2.69s/it] 74%|███████▎  | 287/390 [13:50<04:42,  2.74s/it] 74%|███████▍  | 288/390 [13:53<04:42,  2.77s/it] 74%|███████▍  | 289/390 [13:56<04:42,  2.80s/it] 74%|███████▍  | 290/390 [13:59<04:41,  2.81s/it] 75%|███████▍  | 291/390 [14:02<04:40,  2.83s/it] 75%|███████▍  | 292/390 [14:04<04:38,  2.84s/it] 75%|███████▌  | 293/390 [14:07<04:35,  2.85s/it] 75%|███████▌  | 294/390 [14:10<04:33,  2.85s/it] 76%|███████▌  | 295/390 [14:13<04:30,  2.85s/it] 76%|███████▌  | 296/390 [14:16<04:28,  2.86s/it] 76%|███████▌  | 297/390 [14:19<04:25,  2.86s/it] 76%|███████▋  | 298/390 [14:22<04:22,  2.86s/it] 77%|███████▋  | 299/390 [14:24<04:19,  2.85s/it] 77%|███████▋  | 300/390 [14:27<04:15,  2.84s/it]                                                  77%|███████▋  | 300/390 [14:27<04:15,  2.84s/it] 77%|███████▋  | 301/390 [14:30<04:13,  2.85s/it] 77%|███████▋  | 302/390 [14:33<04:12,  2.87s/it] 78%|███████▊  | 303/390 [14:36<04:11,  2.89s/it] 78%|███████▊  | 304/390 [14:39<04:10,  2.91s/it] 78%|███████▊  | 305/390 [14:42<04:08,  2.92s/it] 78%|███████▊  | 306/390 [14:45<04:06,  2.94s/it] 79%|███████▊  | 307/390 [14:48<04:02,  2.92s/it] 79%|███████▉  | 308/390 [14:51<03:57,  2.89s/it] 79%|███████▉  | 309/390 [14:53<03:52,  2.88s/it] 79%|███████▉  | 310/390 [14:56<03:49,  2.86s/it] 80%|███████▉  | 311/390 [14:59<03:45,  2.85s/it] 80%|████████  | 312/390 [15:01<03:28,  2.67s/it] 80%|████████  | 313/390 [15:04<03:29,  2.72s/it] 81%|████████  | 314/390 [15:07<03:30,  2.76s/it] 81%|████████  | 315/390 [15:10<03:28,  2.79s/it] 81%|████████  | 316/390 [15:13<03:27,  2.80s/it] 81%|████████▏ | 317/390 [15:15<03:25,  2.82s/it] 82%|████████▏ | 318/390 [15:18<03:24,  2.84s/it] 82%|████████▏ | 319/390 [15:21<03:21,  2.84s/it] 82%|████████▏ | 320/390 [15:24<03:20,  2.86s/it]                                                  82%|████████▏ | 320/390 [15:24<03:20,  2.86s/it] 82%|████████▏ | 321/390 [15:27<03:17,  2.86s/it] 83%|████████▎ | 322/390 [15:30<03:14,  2.86s/it] 83%|████████▎ | 323/390 [15:33<03:12,  2.87s/it] 83%|████████▎ | 324/390 [15:36<03:09,  2.87s/it] 83%|████████▎ | 325/390 [15:38<03:06,  2.86s/it] 84%|████████▎ | 326/390 [15:41<03:02,  2.86s/it] 84%|████████▍ | 327/390 [15:44<03:00,  2.86s/it] 84%|████████▍ | 328/390 [15:47<02:57,  2.86s/it] 84%|████████▍ | 329/390 [15:50<02:54,  2.86s/it] 85%|████████▍ | 330/390 [15:53<02:51,  2.86s/it] 85%|████████▍ | 331/390 [15:56<02:48,  2.85s/it] 85%|████████▌ | 332/390 [15:58<02:45,  2.85s/it] 85%|████████▌ | 333/390 [16:01<02:42,  2.85s/it] 86%|████████▌ | 334/390 [16:04<02:39,  2.84s/it] 86%|████████▌ | 335/390 [16:07<02:36,  2.85s/it] 86%|████████▌ | 336/390 [16:10<02:34,  2.86s/it] 86%|████████▋ | 337/390 [16:13<02:31,  2.86s/it] 87%|████████▋ | 338/390 [16:15<02:19,  2.69s/it] 87%|████████▋ | 339/390 [16:18<02:20,  2.75s/it] 87%|████████▋ | 340/390 [16:21<02:19,  2.79s/it]                                                  87%|████████▋ | 340/390 [16:21<02:19,  2.79s/it] 87%|████████▋ | 341/390 [16:24<02:17,  2.81s/it] 88%|████████▊ | 342/390 [16:27<02:15,  2.83s/it] 88%|████████▊ | 343/390 [16:29<02:13,  2.84s/it] 88%|████████▊ | 344/390 [16:32<02:11,  2.86s/it] 88%|████████▊ | 345/390 [16:35<02:08,  2.86s/it] 89%|████████▊ | 346/390 [16:38<02:06,  2.87s/it] 89%|████████▉ | 347/390 [16:41<02:03,  2.88s/it] 89%|████████▉ | 348/390 [16:44<02:00,  2.88s/it] 89%|████████▉ | 349/390 [16:47<01:57,  2.87s/it] 90%|████████▉ | 350/390 [16:50<01:54,  2.86s/it] 90%|█████████ | 351/390 [16:52<01:51,  2.86s/it] 90%|█████████ | 352/390 [16:55<01:48,  2.86s/it] 91%|█████████ | 353/390 [16:58<01:45,  2.86s/it] 91%|█████████ | 354/390 [17:01<01:42,  2.86s/it] 91%|█████████ | 355/390 [17:04<01:39,  2.85s/it] 91%|█████████▏| 356/390 [17:07<01:36,  2.85s/it] 92%|█████████▏| 357/390 [17:09<01:34,  2.85s/it] 92%|█████████▏| 358/390 [17:12<01:31,  2.86s/it] 92%|█████████▏| 359/390 [17:15<01:28,  2.86s/it] 92%|█████████▏| 360/390 [17:18<01:25,  2.85s/it]                                                  92%|█████████▏| 360/390 [17:18<01:25,  2.85s/it] 93%|█████████▎| 361/390 [17:21<01:22,  2.86s/it] 93%|█████████▎| 362/390 [17:24<01:20,  2.87s/it] 93%|█████████▎| 363/390 [17:27<01:17,  2.86s/it] 93%|█████████▎| 364/390 [17:29<01:09,  2.68s/it] 94%|█████████▎| 365/390 [17:32<01:08,  2.73s/it] 94%|█████████▍| 366/390 [17:35<01:06,  2.77s/it] 94%|█████████▍| 367/390 [17:37<01:04,  2.79s/it] 94%|█████████▍| 368/390 [17:40<01:01,  2.81s/it] 95%|█████████▍| 369/390 [17:43<00:59,  2.81s/it] 95%|█████████▍| 370/390 [17:46<00:56,  2.83s/it] 95%|█████████▌| 371/390 [17:49<00:53,  2.84s/it] 95%|█████████▌| 372/390 [17:52<00:51,  2.84s/it] 96%|█████████▌| 373/390 [17:55<00:48,  2.84s/it] 96%|█████████▌| 374/390 [17:57<00:45,  2.84s/it] 96%|█████████▌| 375/390 [18:00<00:42,  2.84s/it] 96%|█████████▋| 376/390 [18:03<00:39,  2.85s/it] 97%|█████████▋| 377/390 [18:06<00:36,  2.84s/it] 97%|█████████▋| 378/390 [18:09<00:34,  2.84s/it] 97%|█████████▋| 379/390 [18:12<00:31,  2.85s/it] 97%|█████████▋| 380/390 [18:14<00:28,  2.84s/it]                                                  97%|█████████▋| 380/390 [18:14<00:28,  2.84s/it] 98%|█████████▊| 381/390 [18:17<00:25,  2.84s/it] 98%|█████████▊| 382/390 [18:20<00:22,  2.83s/it] 98%|█████████▊| 383/390 [18:23<00:19,  2.84s/it] 98%|█████████▊| 384/390 [18:26<00:17,  2.85s/it] 99%|█████████▊| 385/390 [18:29<00:14,  2.86s/it] 99%|█████████▉| 386/390 [18:32<00:11,  2.86s/it] 99%|█████████▉| 387/390 [18:34<00:08,  2.88s/it] 99%|█████████▉| 388/390 [18:37<00:05,  2.87s/it]100%|█████████▉| 389/390 [18:40<00:02,  2.86s/it]100%|██████████| 390/390 [18:42<00:00,  2.68s/it]                                                 100%|██████████| 390/390 [18:42<00:00,  2.68s/it]100%|██████████| 390/390 [18:42<00:00,  2.88s/it]
Fast image processor class <class 'transformers.models.vit.image_processing_vit_fast.ViTImageProcessorFast'> is available for this model. Using slow image processor class. To use the fast image processor class set `use_fast=True`.
{'loss': 2.3178, 'grad_norm': 13.85154914855957, 'learning_rate': 2.435897435897436e-05, 'epoch': 0.77}
{'loss': 2.1094, 'grad_norm': 15.835952758789062, 'learning_rate': 5e-05, 'epoch': 1.54}
{'loss': 1.8371, 'grad_norm': 13.488090515136719, 'learning_rate': 4.7150997150997157e-05, 'epoch': 2.31}
{'loss': 1.5998, 'grad_norm': 19.26374053955078, 'learning_rate': 4.4301994301994304e-05, 'epoch': 3.08}
{'loss': 1.217, 'grad_norm': 14.93503475189209, 'learning_rate': 4.145299145299146e-05, 'epoch': 3.85}
{'loss': 0.8977, 'grad_norm': 11.212202072143555, 'learning_rate': 3.8603988603988605e-05, 'epoch': 4.62}
{'loss': 0.579, 'grad_norm': 8.80854320526123, 'learning_rate': 3.575498575498576e-05, 'epoch': 5.38}
{'loss': 0.4561, 'grad_norm': 5.432144641876221, 'learning_rate': 3.290598290598291e-05, 'epoch': 6.15}
{'loss': 0.3142, 'grad_norm': 10.53466510772705, 'learning_rate': 3.005698005698006e-05, 'epoch': 6.92}
{'loss': 0.1748, 'grad_norm': 3.8235063552856445, 'learning_rate': 2.720797720797721e-05, 'epoch': 7.69}
{'loss': 0.1503, 'grad_norm': 4.999923229217529, 'learning_rate': 2.435897435897436e-05, 'epoch': 8.46}
{'loss': 0.0629, 'grad_norm': 0.6066436767578125, 'learning_rate': 2.150997150997151e-05, 'epoch': 9.23}
{'loss': 0.0509, 'grad_norm': 15.90945816040039, 'learning_rate': 1.866096866096866e-05, 'epoch': 10.0}
{'loss': 0.0302, 'grad_norm': 0.28345608711242676, 'learning_rate': 1.581196581196581e-05, 'epoch': 10.77}
{'loss': 0.0183, 'grad_norm': 0.5192321538925171, 'learning_rate': 1.2962962962962962e-05, 'epoch': 11.54}
{'loss': 0.0103, 'grad_norm': 0.3569982647895813, 'learning_rate': 1.0113960113960115e-05, 'epoch': 12.31}
{'loss': 0.0095, 'grad_norm': 0.2341890186071396, 'learning_rate': 7.264957264957266e-06, 'epoch': 13.08}
{'loss': 0.0086, 'grad_norm': 0.3440280258655548, 'learning_rate': 4.415954415954416e-06, 'epoch': 13.85}
{'loss': 0.007, 'grad_norm': 0.16201208531856537, 'learning_rate': 1.566951566951567e-06, 'epoch': 14.62}
{'train_runtime': 1122.9709, 'train_samples_per_second': 1.376, 'train_steps_per_second': 0.347, 'train_loss': 0.6078948466537091, 'epoch': 15.0}

Tile-level accuracy (spatial split, weighted): 0.366
Confusion matrix (rows=true, cols=pred):
 [[ 3  0  0  0  0  2  5  2  1  1]
 [ 1  1  1  2  0  0  2  0  0  0]
 [ 0  1  1  0  0  1  3  0  1  0]
 [ 0  0  0  4  0  0  4  0  2  0]
 [ 1  0  1  0  1  1  2  0  0  0]
 [ 2  0  0  0  0  0  5  0  0  0]
 [ 2  0  4  0  1  0 13  1  2  0]
 [ 1  0  0  0  0  1  3  2  0  0]
 [ 0  0  1  0  1  0  3  0 12  0]
 [ 1  0  0  0  0  0  0  1  1  0]]
              precision    recall  f1-score   support

           0      0.273     0.214     0.240        14
           1      0.500     0.143     0.222         7
           2      0.125     0.143     0.133         7
           3      0.667     0.400     0.500        10
           4      0.333     0.167     0.222         6
           5      0.000     0.000     0.000         7
           6      0.325     0.565     0.413        23
           7      0.333     0.286     0.308         7
           8      0.632     0.706     0.667        17
           9      0.000     0.000     0.000         3

    accuracy                          0.366       101
   macro avg      0.319     0.262     0.270       101
weighted avg      0.370     0.366     0.348       101

Saved model to: outputs/ip_vit_t16s8_weighted_model
