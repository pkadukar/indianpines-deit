/home/pkadukar/miniconda3/envs/furi310/lib/python3.10/site-packages/transformers/utils/hub.py:110: FutureWarning: Using `TRANSFORMERS_CACHE` is deprecated and will be removed in v5 of Transformers. Use `HF_HOME` instead.
  warnings.warn(
Some weights of ViTForImageClassification were not initialized from the model checkpoint at google/vit-base-patch16-224 and are newly initialized because the shapes did not match:
- classifier.bias: found shape torch.Size([1000]) in the checkpoint and torch.Size([10]) in the model instantiated
- classifier.weight: found shape torch.Size([1000, 768]) in the checkpoint and torch.Size([10, 768]) in the model instantiated
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
Detected kernel version 4.18.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
Loaded: (145, 145, 200) (145, 145)
Grid coords: 289 | train coords: 145 | val coords: 144
Tiles (pre-filter): train=108 val=106
After rarity filter: train=103 val=101 classes=[2, 3, 5, 6, 8, 10, 11, 12, 14, 15]
Train class counts: {3: 7, 12: 8, 15: 3, 11: 26, 2: 14, 14: 18, 10: 7, 8: 6, 6: 7, 5: 7}
Val   class counts: {3: 7, 12: 7, 15: 3, 11: 23, 14: 17, 2: 14, 10: 7, 8: 6, 6: 10, 5: 7}
  0%|          | 0/390 [00:00<?, ?it/s]  0%|          | 1/390 [00:06<43:24,  6.70s/it]  1%|          | 2/390 [00:09<29:00,  4.49s/it]  1%|          | 3/390 [00:12<24:25,  3.79s/it]  1%|          | 4/390 [00:15<22:05,  3.43s/it]  1%|▏         | 5/390 [00:18<20:55,  3.26s/it]  2%|▏         | 6/390 [00:21<20:14,  3.16s/it]  2%|▏         | 7/390 [00:24<19:45,  3.10s/it]  2%|▏         | 8/390 [00:27<19:24,  3.05s/it]  2%|▏         | 9/390 [00:30<19:16,  3.04s/it]  3%|▎         | 10/390 [00:33<19:04,  3.01s/it]  3%|▎         | 11/390 [00:36<18:55,  3.00s/it]  3%|▎         | 12/390 [00:39<18:49,  2.99s/it]  3%|▎         | 13/390 [00:42<18:30,  2.95s/it]  4%|▎         | 14/390 [00:44<18:17,  2.92s/it]  4%|▍         | 15/390 [00:47<18:01,  2.89s/it]  4%|▍         | 16/390 [00:50<17:58,  2.88s/it]  4%|▍         | 17/390 [00:53<18:00,  2.90s/it]  5%|▍         | 18/390 [00:56<17:55,  2.89s/it]  5%|▍         | 19/390 [00:59<17:51,  2.89s/it]  5%|▌         | 20/390 [01:02<17:49,  2.89s/it]                                                  5%|▌         | 20/390 [01:02<17:49,  2.89s/it]  5%|▌         | 21/390 [01:05<17:55,  2.91s/it]  6%|▌         | 22/390 [01:08<17:47,  2.90s/it]  6%|▌         | 23/390 [01:10<17:40,  2.89s/it]  6%|▌         | 24/390 [01:13<17:36,  2.89s/it]  6%|▋         | 25/390 [01:16<17:34,  2.89s/it]  7%|▋         | 26/390 [01:19<16:39,  2.75s/it]  7%|▋         | 27/390 [01:21<16:54,  2.80s/it]  7%|▋         | 28/390 [01:24<16:56,  2.81s/it]  7%|▋         | 29/390 [01:27<17:01,  2.83s/it]  8%|▊         | 30/390 [01:30<17:00,  2.84s/it]  8%|▊         | 31/390 [01:33<16:59,  2.84s/it]  8%|▊         | 32/390 [01:36<16:59,  2.85s/it]  8%|▊         | 33/390 [01:39<16:58,  2.85s/it]  9%|▊         | 34/390 [01:42<16:58,  2.86s/it]  9%|▉         | 35/390 [01:44<16:57,  2.87s/it]  9%|▉         | 36/390 [01:47<16:55,  2.87s/it]  9%|▉         | 37/390 [01:50<17:00,  2.89s/it] 10%|▉         | 38/390 [01:53<17:02,  2.90s/it] 10%|█         | 39/390 [01:56<16:59,  2.91s/it] 10%|█         | 40/390 [01:59<16:58,  2.91s/it]                                                 10%|█         | 40/390 [01:59<16:58,  2.91s/it] 11%|█         | 41/390 [02:02<16:54,  2.91s/it] 11%|█         | 42/390 [02:05<16:49,  2.90s/it] 11%|█         | 43/390 [02:08<16:48,  2.91s/it] 11%|█▏        | 44/390 [02:11<16:42,  2.90s/it] 12%|█▏        | 45/390 [02:13<16:35,  2.88s/it] 12%|█▏        | 46/390 [02:16<16:30,  2.88s/it] 12%|█▏        | 47/390 [02:19<16:23,  2.87s/it] 12%|█▏        | 48/390 [02:22<16:20,  2.87s/it] 13%|█▎        | 49/390 [02:25<16:13,  2.86s/it] 13%|█▎        | 50/390 [02:28<16:12,  2.86s/it] 13%|█▎        | 51/390 [02:31<16:12,  2.87s/it] 13%|█▎        | 52/390 [02:33<15:15,  2.71s/it] 14%|█▎        | 53/390 [02:36<15:32,  2.77s/it] 14%|█▍        | 54/390 [02:39<15:40,  2.80s/it] 14%|█▍        | 55/390 [02:42<15:47,  2.83s/it] 14%|█▍        | 56/390 [02:44<15:51,  2.85s/it] 15%|█▍        | 57/390 [02:47<15:49,  2.85s/it] 15%|█▍        | 58/390 [02:50<15:46,  2.85s/it] 15%|█▌        | 59/390 [02:53<15:42,  2.85s/it] 15%|█▌        | 60/390 [02:56<15:39,  2.85s/it]                                                 15%|█▌        | 60/390 [02:56<15:39,  2.85s/it] 16%|█▌        | 61/390 [02:59<15:39,  2.86s/it] 16%|█▌        | 62/390 [03:02<15:31,  2.84s/it] 16%|█▌        | 63/390 [03:04<15:26,  2.83s/it] 16%|█▋        | 64/390 [03:07<15:24,  2.84s/it] 17%|█▋        | 65/390 [03:10<15:26,  2.85s/it] 17%|█▋        | 66/390 [03:13<15:25,  2.86s/it] 17%|█▋        | 67/390 [03:16<15:22,  2.86s/it] 17%|█▋        | 68/390 [03:19<15:18,  2.85s/it] 18%|█▊        | 69/390 [03:22<15:18,  2.86s/it] 18%|█▊        | 70/390 [03:24<15:20,  2.88s/it] 18%|█▊        | 71/390 [03:27<15:19,  2.88s/it] 18%|█▊        | 72/390 [03:30<15:18,  2.89s/it] 19%|█▊        | 73/390 [03:33<15:18,  2.90s/it] 19%|█▉        | 74/390 [03:36<15:17,  2.90s/it] 19%|█▉        | 75/390 [03:39<15:16,  2.91s/it] 19%|█▉        | 76/390 [03:42<15:11,  2.90s/it] 20%|█▉        | 77/390 [03:45<15:08,  2.90s/it] 20%|██        | 78/390 [03:47<14:05,  2.71s/it] 20%|██        | 79/390 [03:50<14:23,  2.78s/it] 21%|██        | 80/390 [03:53<14:27,  2.80s/it]                                                 21%|██        | 80/390 [03:53<14:27,  2.80s/it] 21%|██        | 81/390 [03:56<14:29,  2.81s/it] 21%|██        | 82/390 [03:59<14:33,  2.83s/it] 21%|██▏       | 83/390 [04:01<14:36,  2.85s/it] 22%|██▏       | 84/390 [04:04<14:29,  2.84s/it] 22%|██▏       | 85/390 [04:07<14:26,  2.84s/it] 22%|██▏       | 86/390 [04:10<14:26,  2.85s/it] 22%|██▏       | 87/390 [04:13<14:29,  2.87s/it] 23%|██▎       | 88/390 [04:16<14:30,  2.88s/it] 23%|██▎       | 89/390 [04:19<14:28,  2.88s/it] 23%|██▎       | 90/390 [04:22<14:24,  2.88s/it] 23%|██▎       | 91/390 [04:24<14:20,  2.88s/it] 24%|██▎       | 92/390 [04:27<14:17,  2.88s/it] 24%|██▍       | 93/390 [04:30<14:15,  2.88s/it] 24%|██▍       | 94/390 [04:33<14:15,  2.89s/it] 24%|██▍       | 95/390 [04:36<14:16,  2.90s/it] 25%|██▍       | 96/390 [04:39<14:15,  2.91s/it] 25%|██▍       | 97/390 [04:42<14:12,  2.91s/it] 25%|██▌       | 98/390 [04:45<14:08,  2.91s/it] 25%|██▌       | 99/390 [04:48<14:04,  2.90s/it] 26%|██▌       | 100/390 [04:51<14:01,  2.90s/it]                                                  26%|██▌       | 100/390 [04:51<14:01,  2.90s/it] 26%|██▌       | 101/390 [04:54<14:00,  2.91s/it] 26%|██▌       | 102/390 [04:56<13:56,  2.91s/it] 26%|██▋       | 103/390 [04:59<13:52,  2.90s/it] 27%|██▋       | 104/390 [05:02<12:55,  2.71s/it] 27%|██▋       | 105/390 [05:04<13:06,  2.76s/it] 27%|██▋       | 106/390 [05:07<13:17,  2.81s/it] 27%|██▋       | 107/390 [05:10<13:24,  2.84s/it] 28%|██▊       | 108/390 [05:13<13:32,  2.88s/it] 28%|██▊       | 109/390 [05:16<13:40,  2.92s/it] 28%|██▊       | 110/390 [05:19<13:44,  2.94s/it] 28%|██▊       | 111/390 [05:22<13:39,  2.94s/it] 29%|██▊       | 112/390 [05:25<13:34,  2.93s/it] 29%|██▉       | 113/390 [05:28<13:31,  2.93s/it] 29%|██▉       | 114/390 [05:31<13:23,  2.91s/it] 29%|██▉       | 115/390 [05:34<13:20,  2.91s/it] 30%|██▉       | 116/390 [05:37<13:18,  2.91s/it] 30%|███       | 117/390 [05:40<13:13,  2.91s/it] 30%|███       | 118/390 [05:43<13:07,  2.89s/it] 31%|███       | 119/390 [05:45<12:59,  2.88s/it] 31%|███       | 120/390 [05:48<13:00,  2.89s/it]                                                  31%|███       | 120/390 [05:48<13:00,  2.89s/it] 31%|███       | 121/390 [05:51<12:56,  2.89s/it] 31%|███▏      | 122/390 [05:54<12:54,  2.89s/it] 32%|███▏      | 123/390 [05:57<12:50,  2.89s/it] 32%|███▏      | 124/390 [06:00<12:50,  2.90s/it] 32%|███▏      | 125/390 [06:03<12:49,  2.90s/it] 32%|███▏      | 126/390 [06:06<12:48,  2.91s/it] 33%|███▎      | 127/390 [06:09<12:44,  2.91s/it] 33%|███▎      | 128/390 [06:11<12:40,  2.90s/it] 33%|███▎      | 129/390 [06:14<12:36,  2.90s/it] 33%|███▎      | 130/390 [06:17<11:44,  2.71s/it] 34%|███▎      | 131/390 [06:20<11:54,  2.76s/it] 34%|███▍      | 132/390 [06:22<12:02,  2.80s/it] 34%|███▍      | 133/390 [06:25<12:10,  2.84s/it] 34%|███▍      | 134/390 [06:28<12:13,  2.86s/it] 35%|███▍      | 135/390 [06:31<12:12,  2.87s/it] 35%|███▍      | 136/390 [06:34<12:09,  2.87s/it] 35%|███▌      | 137/390 [06:37<12:08,  2.88s/it] 35%|███▌      | 138/390 [06:40<12:02,  2.87s/it] 36%|███▌      | 139/390 [06:43<11:59,  2.87s/it] 36%|███▌      | 140/390 [06:45<11:54,  2.86s/it]                                                  36%|███▌      | 140/390 [06:45<11:54,  2.86s/it] 36%|███▌      | 141/390 [06:48<11:49,  2.85s/it] 36%|███▋      | 142/390 [06:51<11:46,  2.85s/it] 37%|███▋      | 143/390 [06:54<11:47,  2.86s/it] 37%|███▋      | 144/390 [06:57<11:50,  2.89s/it] 37%|███▋      | 145/390 [07:00<11:48,  2.89s/it] 37%|███▋      | 146/390 [07:03<11:44,  2.89s/it] 38%|███▊      | 147/390 [07:06<11:41,  2.89s/it] 38%|███▊      | 148/390 [07:09<11:38,  2.89s/it] 38%|███▊      | 149/390 [07:11<11:36,  2.89s/it] 38%|███▊      | 150/390 [07:14<11:31,  2.88s/it] 39%|███▊      | 151/390 [07:17<11:25,  2.87s/it] 39%|███▉      | 152/390 [07:20<11:21,  2.86s/it] 39%|███▉      | 153/390 [07:23<11:19,  2.87s/it] 39%|███▉      | 154/390 [07:26<11:15,  2.86s/it] 40%|███▉      | 155/390 [07:29<11:11,  2.86s/it] 40%|████      | 156/390 [07:31<10:29,  2.69s/it] 40%|████      | 157/390 [07:34<10:40,  2.75s/it] 41%|████      | 158/390 [07:37<10:47,  2.79s/it] 41%|████      | 159/390 [07:40<10:51,  2.82s/it] 41%|████      | 160/390 [07:42<10:53,  2.84s/it]                                                  41%|████      | 160/390 [07:42<10:53,  2.84s/it] 41%|████▏     | 161/390 [07:45<10:58,  2.87s/it] 42%|████▏     | 162/390 [07:48<10:54,  2.87s/it] 42%|████▏     | 163/390 [07:51<10:53,  2.88s/it] 42%|████▏     | 164/390 [07:54<10:53,  2.89s/it] 42%|████▏     | 165/390 [07:57<10:53,  2.90s/it] 43%|████▎     | 166/390 [08:00<10:52,  2.91s/it] 43%|████▎     | 167/390 [08:03<10:49,  2.91s/it] 43%|████▎     | 168/390 [08:06<10:48,  2.92s/it] 43%|████▎     | 169/390 [08:09<10:46,  2.93s/it] 44%|████▎     | 170/390 [08:12<10:41,  2.91s/it] 44%|████▍     | 171/390 [08:14<10:36,  2.90s/it] 44%|████▍     | 172/390 [08:17<10:33,  2.91s/it] 44%|████▍     | 173/390 [08:20<10:32,  2.92s/it] 45%|████▍     | 174/390 [08:23<10:28,  2.91s/it] 45%|████▍     | 175/390 [08:26<10:27,  2.92s/it] 45%|████▌     | 176/390 [08:29<10:24,  2.92s/it] 45%|████▌     | 177/390 [08:32<10:22,  2.92s/it] 46%|████▌     | 178/390 [08:35<10:21,  2.93s/it] 46%|████▌     | 179/390 [08:38<10:19,  2.94s/it] 46%|████▌     | 180/390 [08:41<10:14,  2.93s/it]                                                  46%|████▌     | 180/390 [08:41<10:14,  2.93s/it] 46%|████▋     | 181/390 [08:44<10:10,  2.92s/it] 47%|████▋     | 182/390 [08:46<09:27,  2.73s/it] 47%|████▋     | 183/390 [08:49<09:33,  2.77s/it] 47%|████▋     | 184/390 [08:52<09:39,  2.82s/it] 47%|████▋     | 185/390 [08:55<09:43,  2.85s/it] 48%|████▊     | 186/390 [08:58<09:43,  2.86s/it] 48%|████▊     | 187/390 [09:00<09:42,  2.87s/it] 48%|████▊     | 188/390 [09:03<09:40,  2.87s/it] 48%|████▊     | 189/390 [09:06<09:41,  2.89s/it] 49%|████▊     | 190/390 [09:09<09:38,  2.89s/it] 49%|████▉     | 191/390 [09:12<09:38,  2.91s/it] 49%|████▉     | 192/390 [09:15<09:34,  2.90s/it] 49%|████▉     | 193/390 [09:18<09:29,  2.89s/it] 50%|████▉     | 194/390 [09:21<09:24,  2.88s/it] 50%|█████     | 195/390 [09:24<09:18,  2.87s/it] 50%|█████     | 196/390 [09:26<09:14,  2.86s/it] 51%|█████     | 197/390 [09:29<09:12,  2.86s/it] 51%|█████     | 198/390 [09:32<09:13,  2.88s/it] 51%|█████     | 199/390 [09:35<09:13,  2.90s/it] 51%|█████▏    | 200/390 [09:38<09:08,  2.89s/it]                                                  51%|█████▏    | 200/390 [09:38<09:08,  2.89s/it] 52%|█████▏    | 201/390 [09:41<09:07,  2.90s/it] 52%|█████▏    | 202/390 [09:44<09:03,  2.89s/it] 52%|█████▏    | 203/390 [09:47<08:58,  2.88s/it] 52%|█████▏    | 204/390 [09:50<08:54,  2.87s/it] 53%|█████▎    | 205/390 [09:52<08:54,  2.89s/it] 53%|█████▎    | 206/390 [09:55<08:52,  2.89s/it] 53%|█████▎    | 207/390 [09:58<08:46,  2.87s/it] 53%|█████▎    | 208/390 [10:00<08:07,  2.68s/it] 54%|█████▎    | 209/390 [10:03<08:15,  2.74s/it] 54%|█████▍    | 210/390 [10:06<08:21,  2.79s/it] 54%|█████▍    | 211/390 [10:09<08:28,  2.84s/it] 54%|█████▍    | 212/390 [10:12<08:31,  2.88s/it] 55%|█████▍    | 213/390 [10:15<08:30,  2.88s/it] 55%|█████▍    | 214/390 [10:18<08:29,  2.89s/it] 55%|█████▌    | 215/390 [10:21<08:28,  2.90s/it] 55%|█████▌    | 216/390 [10:24<08:26,  2.91s/it] 56%|█████▌    | 217/390 [10:27<08:25,  2.92s/it] 56%|█████▌    | 218/390 [10:30<08:21,  2.91s/it] 56%|█████▌    | 219/390 [10:33<08:18,  2.91s/it] 56%|█████▋    | 220/390 [10:35<08:14,  2.91s/it]                                                  56%|█████▋    | 220/390 [10:35<08:14,  2.91s/it] 57%|█████▋    | 221/390 [10:38<08:10,  2.90s/it] 57%|█████▋    | 222/390 [10:41<08:06,  2.90s/it] 57%|█████▋    | 223/390 [10:44<08:04,  2.90s/it] 57%|█████▋    | 224/390 [10:47<08:00,  2.89s/it] 58%|█████▊    | 225/390 [10:50<07:58,  2.90s/it] 58%|█████▊    | 226/390 [10:53<07:57,  2.91s/it] 58%|█████▊    | 227/390 [10:56<07:54,  2.91s/it] 58%|█████▊    | 228/390 [10:59<07:52,  2.91s/it] 59%|█████▊    | 229/390 [11:02<07:48,  2.91s/it] 59%|█████▉    | 230/390 [11:05<07:47,  2.92s/it] 59%|█████▉    | 231/390 [11:07<07:43,  2.92s/it] 59%|█████▉    | 232/390 [11:10<07:37,  2.90s/it] 60%|█████▉    | 233/390 [11:13<07:36,  2.91s/it] 60%|██████    | 234/390 [11:16<07:05,  2.73s/it] 60%|██████    | 235/390 [11:18<07:08,  2.77s/it] 61%|██████    | 236/390 [11:21<07:10,  2.79s/it] 61%|██████    | 237/390 [11:24<07:11,  2.82s/it] 61%|██████    | 238/390 [11:27<07:12,  2.85s/it] 61%|██████▏   | 239/390 [11:30<07:12,  2.86s/it] 62%|██████▏   | 240/390 [11:33<07:10,  2.87s/it]                                                  62%|██████▏   | 240/390 [11:33<07:10,  2.87s/it] 62%|██████▏   | 241/390 [11:36<07:08,  2.88s/it] 62%|██████▏   | 242/390 [11:39<07:07,  2.89s/it] 62%|██████▏   | 243/390 [11:42<07:07,  2.91s/it] 63%|██████▎   | 244/390 [11:45<07:05,  2.91s/it] 63%|██████▎   | 245/390 [11:47<07:01,  2.91s/it] 63%|██████▎   | 246/390 [11:50<06:57,  2.90s/it] 63%|██████▎   | 247/390 [11:53<06:55,  2.90s/it] 64%|██████▎   | 248/390 [11:56<06:50,  2.89s/it] 64%|██████▍   | 249/390 [11:59<06:47,  2.89s/it] 64%|██████▍   | 250/390 [12:02<06:43,  2.88s/it] 64%|██████▍   | 251/390 [12:05<06:41,  2.89s/it] 65%|██████▍   | 252/390 [12:08<06:38,  2.89s/it] 65%|██████▍   | 253/390 [12:10<06:34,  2.88s/it] 65%|██████▌   | 254/390 [12:13<06:32,  2.88s/it] 65%|██████▌   | 255/390 [12:16<06:28,  2.88s/it] 66%|██████▌   | 256/390 [12:19<06:26,  2.88s/it] 66%|██████▌   | 257/390 [12:22<06:24,  2.89s/it] 66%|██████▌   | 258/390 [12:25<06:20,  2.88s/it] 66%|██████▋   | 259/390 [12:28<06:17,  2.88s/it] 67%|██████▋   | 260/390 [12:30<05:52,  2.71s/it]                                                  67%|██████▋   | 260/390 [12:30<05:52,  2.71s/it] 67%|██████▋   | 261/390 [12:33<05:56,  2.76s/it] 67%|██████▋   | 262/390 [12:36<05:56,  2.79s/it] 67%|██████▋   | 263/390 [12:39<05:55,  2.80s/it] 68%|██████▊   | 264/390 [12:41<05:55,  2.82s/it] 68%|██████▊   | 265/390 [12:44<05:54,  2.83s/it] 68%|██████▊   | 266/390 [12:47<05:51,  2.84s/it] 68%|██████▊   | 267/390 [12:50<05:49,  2.84s/it] 69%|██████▊   | 268/390 [12:53<05:48,  2.85s/it] 69%|██████▉   | 269/390 [12:56<05:46,  2.86s/it] 69%|██████▉   | 270/390 [12:59<05:45,  2.88s/it] 69%|██████▉   | 271/390 [13:02<05:42,  2.88s/it] 70%|██████▉   | 272/390 [13:04<05:39,  2.88s/it] 70%|███████   | 273/390 [13:07<05:36,  2.88s/it] 70%|███████   | 274/390 [13:10<05:35,  2.89s/it] 71%|███████   | 275/390 [13:13<05:33,  2.90s/it] 71%|███████   | 276/390 [13:16<05:31,  2.91s/it] 71%|███████   | 277/390 [13:19<05:29,  2.91s/it] 71%|███████▏  | 278/390 [13:22<05:25,  2.91s/it] 72%|███████▏  | 279/390 [13:25<05:22,  2.90s/it] 72%|███████▏  | 280/390 [13:28<05:19,  2.90s/it]                                                  72%|███████▏  | 280/390 [13:28<05:19,  2.90s/it] 72%|███████▏  | 281/390 [13:31<05:16,  2.90s/it] 72%|███████▏  | 282/390 [13:34<05:13,  2.91s/it] 73%|███████▎  | 283/390 [13:36<05:10,  2.90s/it] 73%|███████▎  | 284/390 [13:39<05:04,  2.88s/it] 73%|███████▎  | 285/390 [13:42<05:00,  2.86s/it] 73%|███████▎  | 286/390 [13:44<04:39,  2.69s/it] 74%|███████▎  | 287/390 [13:47<04:42,  2.75s/it] 74%|███████▍  | 288/390 [13:50<04:42,  2.77s/it] 74%|███████▍  | 289/390 [13:53<04:43,  2.80s/it] 74%|███████▍  | 290/390 [13:56<04:42,  2.83s/it] 75%|███████▍  | 291/390 [13:59<04:41,  2.85s/it] 75%|███████▍  | 292/390 [14:02<04:39,  2.86s/it] 75%|███████▌  | 293/390 [14:05<04:39,  2.88s/it] 75%|███████▌  | 294/390 [14:07<04:37,  2.89s/it] 76%|███████▌  | 295/390 [14:10<04:32,  2.87s/it] 76%|███████▌  | 296/390 [14:13<04:28,  2.86s/it] 76%|███████▌  | 297/390 [14:16<04:28,  2.88s/it] 76%|███████▋  | 298/390 [14:19<04:25,  2.88s/it] 77%|███████▋  | 299/390 [14:22<04:21,  2.87s/it] 77%|███████▋  | 300/390 [14:25<04:16,  2.86s/it]                                                  77%|███████▋  | 300/390 [14:25<04:16,  2.86s/it] 77%|███████▋  | 301/390 [14:27<04:14,  2.86s/it] 77%|███████▋  | 302/390 [14:30<04:11,  2.85s/it] 78%|███████▊  | 303/390 [14:33<04:09,  2.87s/it] 78%|███████▊  | 304/390 [14:36<04:09,  2.90s/it] 78%|███████▊  | 305/390 [14:39<04:06,  2.90s/it] 78%|███████▊  | 306/390 [14:42<04:04,  2.91s/it] 79%|███████▊  | 307/390 [14:45<04:02,  2.92s/it] 79%|███████▉  | 308/390 [14:48<03:59,  2.92s/it] 79%|███████▉  | 309/390 [14:51<03:56,  2.91s/it] 79%|███████▉  | 310/390 [14:54<03:52,  2.91s/it] 80%|███████▉  | 311/390 [14:57<03:48,  2.89s/it] 80%|████████  | 312/390 [14:59<03:30,  2.70s/it] 80%|████████  | 313/390 [15:02<03:32,  2.76s/it] 81%|████████  | 314/390 [15:05<03:32,  2.80s/it] 81%|████████  | 315/390 [15:08<03:33,  2.84s/it] 81%|████████  | 316/390 [15:10<03:32,  2.87s/it] 81%|████████▏ | 317/390 [15:13<03:30,  2.88s/it] 82%|████████▏ | 318/390 [15:16<03:26,  2.87s/it] 82%|████████▏ | 319/390 [15:19<03:22,  2.85s/it] 82%|████████▏ | 320/390 [15:22<03:18,  2.84s/it]                                                  82%|████████▏ | 320/390 [15:22<03:18,  2.84s/it] 82%|████████▏ | 321/390 [15:25<03:15,  2.84s/it] 83%|████████▎ | 322/390 [15:28<03:13,  2.84s/it] 83%|████████▎ | 323/390 [15:30<03:10,  2.84s/it] 83%|████████▎ | 324/390 [15:33<03:07,  2.83s/it] 83%|████████▎ | 325/390 [15:36<03:04,  2.84s/it] 84%|████████▎ | 326/390 [15:39<03:02,  2.86s/it] 84%|████████▍ | 327/390 [15:42<02:59,  2.85s/it] 84%|████████▍ | 328/390 [15:45<02:57,  2.86s/it] 84%|████████▍ | 329/390 [15:48<02:54,  2.86s/it] 85%|████████▍ | 330/390 [15:50<02:51,  2.86s/it] 85%|████████▍ | 331/390 [15:53<02:48,  2.86s/it] 85%|████████▌ | 332/390 [15:56<02:46,  2.86s/it] 85%|████████▌ | 333/390 [15:59<02:43,  2.86s/it] 86%|████████▌ | 334/390 [16:02<02:40,  2.86s/it] 86%|████████▌ | 335/390 [16:05<02:37,  2.87s/it] 86%|████████▌ | 336/390 [16:08<02:35,  2.89s/it] 86%|████████▋ | 337/390 [16:11<02:33,  2.90s/it] 87%|████████▋ | 338/390 [16:13<02:21,  2.72s/it] 87%|████████▋ | 339/390 [16:16<02:21,  2.78s/it] 87%|████████▋ | 340/390 [16:19<02:20,  2.82s/it]                                                  87%|████████▋ | 340/390 [16:19<02:20,  2.82s/it] 87%|████████▋ | 341/390 [16:22<02:18,  2.83s/it] 88%|████████▊ | 342/390 [16:24<02:15,  2.83s/it] 88%|████████▊ | 343/390 [16:27<02:13,  2.84s/it] 88%|████████▊ | 344/390 [16:30<02:11,  2.85s/it] 88%|████████▊ | 345/390 [16:33<02:08,  2.85s/it] 89%|████████▊ | 346/390 [16:36<02:04,  2.84s/it] 89%|████████▉ | 347/390 [16:39<02:02,  2.84s/it] 89%|████████▉ | 348/390 [16:42<02:00,  2.87s/it] 89%|████████▉ | 349/390 [16:44<01:57,  2.88s/it] 90%|████████▉ | 350/390 [16:47<01:55,  2.88s/it] 90%|█████████ | 351/390 [16:50<01:52,  2.88s/it] 90%|█████████ | 352/390 [16:53<01:49,  2.89s/it] 91%|█████████ | 353/390 [16:56<01:46,  2.87s/it] 91%|█████████ | 354/390 [16:59<01:43,  2.87s/it] 91%|█████████ | 355/390 [17:02<01:40,  2.88s/it] 91%|█████████▏| 356/390 [17:05<01:38,  2.90s/it] 92%|█████████▏| 357/390 [17:08<01:35,  2.90s/it] 92%|█████████▏| 358/390 [17:11<01:33,  2.91s/it] 92%|█████████▏| 359/390 [17:13<01:29,  2.90s/it] 92%|█████████▏| 360/390 [17:16<01:27,  2.91s/it]                                                  92%|█████████▏| 360/390 [17:16<01:27,  2.91s/it] 93%|█████████▎| 361/390 [17:19<01:23,  2.89s/it] 93%|█████████▎| 362/390 [17:22<01:20,  2.88s/it] 93%|█████████▎| 363/390 [17:25<01:17,  2.88s/it] 93%|█████████▎| 364/390 [17:27<01:09,  2.69s/it] 94%|█████████▎| 365/390 [17:30<01:08,  2.75s/it] 94%|█████████▍| 366/390 [17:33<01:07,  2.79s/it] 94%|█████████▍| 367/390 [17:36<01:04,  2.82s/it] 94%|█████████▍| 368/390 [17:39<01:02,  2.84s/it] 95%|█████████▍| 369/390 [17:42<01:00,  2.86s/it] 95%|█████████▍| 370/390 [17:45<00:57,  2.88s/it] 95%|█████████▌| 371/390 [17:47<00:54,  2.87s/it] 95%|█████████▌| 372/390 [17:50<00:51,  2.88s/it] 96%|█████████▌| 373/390 [17:53<00:49,  2.88s/it] 96%|█████████▌| 374/390 [17:56<00:46,  2.89s/it] 96%|█████████▌| 375/390 [17:59<00:43,  2.88s/it] 96%|█████████▋| 376/390 [18:02<00:40,  2.87s/it] 97%|█████████▋| 377/390 [18:05<00:37,  2.86s/it] 97%|█████████▋| 378/390 [18:07<00:34,  2.85s/it] 97%|█████████▋| 379/390 [18:10<00:31,  2.86s/it] 97%|█████████▋| 380/390 [18:13<00:28,  2.84s/it]                                                  97%|█████████▋| 380/390 [18:13<00:28,  2.84s/it] 98%|█████████▊| 381/390 [18:16<00:25,  2.86s/it] 98%|█████████▊| 382/390 [18:19<00:23,  2.88s/it] 98%|█████████▊| 383/390 [18:22<00:20,  2.88s/it] 98%|█████████▊| 384/390 [18:25<00:17,  2.87s/it] 99%|█████████▊| 385/390 [18:28<00:14,  2.88s/it] 99%|█████████▉| 386/390 [18:30<00:11,  2.89s/it] 99%|█████████▉| 387/390 [18:33<00:08,  2.90s/it] 99%|█████████▉| 388/390 [18:36<00:05,  2.91s/it]100%|█████████▉| 389/390 [18:39<00:02,  2.91s/it]100%|██████████| 390/390 [18:42<00:00,  2.73s/it]                                                 100%|██████████| 390/390 [18:42<00:00,  2.73s/it]100%|██████████| 390/390 [18:42<00:00,  2.88s/it]
Fast image processor class <class 'transformers.models.vit.image_processing_vit_fast.ViTImageProcessorFast'> is available for this model. Using slow image processor class. To use the fast image processor class set `use_fast=True`.
{'loss': 2.2721, 'grad_norm': 12.573746681213379, 'learning_rate': 2.435897435897436e-05, 'epoch': 0.77}
{'loss': 2.1184, 'grad_norm': 14.495964050292969, 'learning_rate': 5e-05, 'epoch': 1.54}
{'loss': 1.8401, 'grad_norm': 13.846181869506836, 'learning_rate': 4.7150997150997157e-05, 'epoch': 2.31}
{'loss': 1.5811, 'grad_norm': 12.907774925231934, 'learning_rate': 4.4301994301994304e-05, 'epoch': 3.08}
{'loss': 1.074, 'grad_norm': 13.739677429199219, 'learning_rate': 4.145299145299146e-05, 'epoch': 3.85}
{'loss': 0.9496, 'grad_norm': 17.99207878112793, 'learning_rate': 3.8603988603988605e-05, 'epoch': 4.62}
{'loss': 0.513, 'grad_norm': 8.694923400878906, 'learning_rate': 3.575498575498576e-05, 'epoch': 5.38}
{'loss': 0.4031, 'grad_norm': 5.35688591003418, 'learning_rate': 3.290598290598291e-05, 'epoch': 6.15}
{'loss': 0.2583, 'grad_norm': 7.4774274826049805, 'learning_rate': 3.005698005698006e-05, 'epoch': 6.92}
{'loss': 0.1503, 'grad_norm': 14.461825370788574, 'learning_rate': 2.720797720797721e-05, 'epoch': 7.69}
{'loss': 0.0959, 'grad_norm': 2.7039263248443604, 'learning_rate': 2.435897435897436e-05, 'epoch': 8.46}
{'loss': 0.0509, 'grad_norm': 0.7356613874435425, 'learning_rate': 2.150997150997151e-05, 'epoch': 9.23}
{'loss': 0.0355, 'grad_norm': 7.871407985687256, 'learning_rate': 1.866096866096866e-05, 'epoch': 10.0}
{'loss': 0.0205, 'grad_norm': 0.3910321593284607, 'learning_rate': 1.581196581196581e-05, 'epoch': 10.77}
{'loss': 0.0386, 'grad_norm': 1.1653716564178467, 'learning_rate': 1.2962962962962962e-05, 'epoch': 11.54}
{'loss': 0.0082, 'grad_norm': 0.35368219017982483, 'learning_rate': 1.0113960113960115e-05, 'epoch': 12.31}
{'loss': 0.0113, 'grad_norm': 0.3252835273742676, 'learning_rate': 7.264957264957266e-06, 'epoch': 13.08}
{'loss': 0.0072, 'grad_norm': 0.19352053105831146, 'learning_rate': 4.415954415954416e-06, 'epoch': 13.85}
{'loss': 0.0069, 'grad_norm': 0.0927516371011734, 'learning_rate': 1.566951566951567e-06, 'epoch': 14.62}
{'train_runtime': 1122.0892, 'train_samples_per_second': 1.377, 'train_steps_per_second': 0.348, 'train_loss': 0.5865521396104342, 'epoch': 15.0}

Tile-level accuracy (spatial split, weighted): 0.386
Confusion matrix (rows=true, cols=pred):
 [[ 5  1  0  0  0  2  2  2  2  0]
 [ 0  3  0  1  0  0  2  1  0  0]
 [ 0  1  0  2  0  0  4  0  0  0]
 [ 0  1  0  0  0  0  4  0  5  0]
 [ 1  0  1  0  2  1  1  0  0  0]
 [ 0  0  0  0  0  0  7  0  0  0]
 [ 1  0  1  0  1  2 13  2  3  0]
 [ 1  0  0  0  0  0  2  3  0  1]
 [ 2  0  0  0  0  0  2  1 12  0]
 [ 0  0  0  0  0  0  1  0  1  1]]
              precision    recall  f1-score   support

           0      0.500     0.357     0.417        14
           1      0.500     0.429     0.462         7
           2      0.000     0.000     0.000         7
           3      0.000     0.000     0.000        10
           4      0.667     0.333     0.444         6
           5      0.000     0.000     0.000         7
           6      0.342     0.565     0.426        23
           7      0.333     0.429     0.375         7
           8      0.522     0.706     0.600        17
           9      0.500     0.333     0.400         3

    accuracy                          0.386       101
   macro avg      0.336     0.315     0.312       101
weighted avg      0.347     0.386     0.352       101

Saved model to: outputs/ip_vit_t16s8_weighted_model
